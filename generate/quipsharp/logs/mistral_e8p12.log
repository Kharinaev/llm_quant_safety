2024-09-02 15:54:34,671 - quantizer - INFO - Start quantizing block model.layers 1/32
2024-09-02 15:54:34,673 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-02 16:39:46,645 - quantizer - INFO - Quantizing self_attn.q_proj in block 1/32...
2024-09-02 16:40:33,381 - quantizer - INFO - Quantizing self_attn.k_proj in block 1/32...
2024-09-02 16:40:48,886 - quantizer - INFO - Quantizing self_attn.v_proj in block 1/32...
2024-09-02 16:41:15,906 - quantizer - INFO - Block 1 initial loss 3.220737934112549
2024-09-02 16:42:52,946 - quantizer - INFO - Quantizing self_attn.o_proj in block 1/32...
2024-09-02 16:43:48,064 - quantizer - INFO - Block 1 initial loss 848883.0625
2024-09-02 16:45:17,131 - quantizer - INFO - Quantizing mlp.gate_proj in block 1/32...
2024-09-02 16:47:52,614 - quantizer - INFO - Quantizing mlp.up_proj in block 1/32...
2024-09-02 16:50:36,851 - quantizer - INFO - Block 1 initial loss 4909125.5
2024-09-02 16:52:05,061 - quantizer - INFO - Quantizing mlp.down_proj in block 1/32...
2024-09-02 16:54:53,193 - quantizer - INFO - Start quantizing block model.layers 2/32
2024-09-02 16:54:53,194 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-02 17:40:04,309 - quantizer - INFO - Quantizing self_attn.q_proj in block 2/32...
2024-09-02 17:40:52,633 - quantizer - INFO - Quantizing self_attn.k_proj in block 2/32...
2024-09-02 17:41:07,278 - quantizer - INFO - Quantizing self_attn.v_proj in block 2/32...
2024-09-02 17:41:34,532 - quantizer - INFO - Block 2 initial loss 2.4130711555480957
2024-09-02 17:43:11,938 - quantizer - INFO - Quantizing self_attn.o_proj in block 2/32...
2024-09-02 17:44:09,388 - quantizer - INFO - Block 2 initial loss 417081.0625
2024-09-02 17:45:45,637 - quantizer - INFO - Quantizing mlp.gate_proj in block 2/32...
2024-09-02 17:48:19,122 - quantizer - INFO - Quantizing mlp.up_proj in block 2/32...
2024-09-02 17:51:02,311 - quantizer - INFO - Block 2 initial loss 45504772.0
2024-09-02 17:52:28,331 - quantizer - INFO - Quantizing mlp.down_proj in block 2/32...
2024-09-02 17:55:16,695 - quantizer - INFO - Start quantizing block model.layers 3/32
2024-09-02 17:55:16,698 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-02 18:40:25,456 - quantizer - INFO - Quantizing self_attn.q_proj in block 3/32...
2024-09-02 18:41:14,366 - quantizer - INFO - Quantizing self_attn.k_proj in block 3/32...
2024-09-02 18:41:26,393 - quantizer - INFO - Quantizing self_attn.v_proj in block 3/32...
2024-09-02 18:41:50,094 - quantizer - INFO - Block 3 initial loss 6.372129440307617
2024-09-02 18:42:22,511 - quantizer - INFO - Block 3 @ epoch 0 new loss 6.102711200714111 old loss 6.372129440307617 BETTER
2024-09-02 18:43:25,384 - quantizer - INFO - Block 3 @ epoch 2 new loss 6.03817081451416 old loss 6.102711200714111 BETTER
2024-09-02 18:44:30,338 - quantizer - INFO - Quantizing self_attn.o_proj in block 3/32...
2024-09-02 18:45:31,365 - quantizer - INFO - Block 3 initial loss 1211278.75
2024-09-02 18:47:06,792 - quantizer - INFO - Quantizing mlp.gate_proj in block 3/32...
2024-09-02 18:49:42,613 - quantizer - INFO - Quantizing mlp.up_proj in block 3/32...
2024-09-02 18:52:25,667 - quantizer - INFO - Block 3 initial loss 4763806.5
2024-09-02 18:52:55,499 - quantizer - INFO - Block 3 @ epoch 0 new loss 4746535.5 old loss 4763806.5 BETTER
2024-09-02 18:53:24,533 - quantizer - INFO - Block 3 @ epoch 1 new loss 4739291.5 old loss 4746535.5 BETTER
2024-09-02 18:54:45,852 - quantizer - INFO - Quantizing mlp.down_proj in block 3/32...
2024-09-02 18:57:32,713 - quantizer - INFO - Start quantizing block model.layers 4/32
2024-09-02 18:57:32,715 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-02 19:43:10,501 - quantizer - INFO - Quantizing self_attn.q_proj in block 4/32...
2024-09-02 19:43:59,514 - quantizer - INFO - Quantizing self_attn.k_proj in block 4/32...
2024-09-02 19:44:11,776 - quantizer - INFO - Quantizing self_attn.v_proj in block 4/32...
2024-09-02 19:44:37,305 - quantizer - INFO - Block 4 initial loss 3.943274736404419
2024-09-02 19:45:11,904 - quantizer - INFO - Block 4 @ epoch 0 new loss 3.4067962169647217 old loss 3.943274736404419 BETTER
2024-09-02 19:45:46,671 - quantizer - INFO - Block 4 @ epoch 1 new loss 3.3976423740386963 old loss 3.4067962169647217 BETTER
2024-09-02 19:46:21,809 - quantizer - INFO - Block 4 @ epoch 2 new loss 3.3962528705596924 old loss 3.3976423740386963 BETTER
2024-09-02 19:47:31,096 - quantizer - INFO - Quantizing self_attn.o_proj in block 4/32...
2024-09-02 19:48:32,986 - quantizer - INFO - Block 4 initial loss 546407.5
2024-09-02 19:50:15,497 - quantizer - INFO - Quantizing mlp.gate_proj in block 4/32...
2024-09-02 19:52:49,494 - quantizer - INFO - Quantizing mlp.up_proj in block 4/32...
2024-09-02 19:55:34,765 - quantizer - INFO - Block 4 initial loss 20083682.0
2024-09-02 19:56:07,437 - quantizer - INFO - Block 4 @ epoch 0 new loss 19859830.0 old loss 20083682.0 BETTER
2024-09-02 19:57:41,844 - quantizer - INFO - Quantizing mlp.down_proj in block 4/32...
2024-09-02 20:00:29,654 - quantizer - INFO - Start quantizing block model.layers 5/32
2024-09-02 20:00:29,656 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-02 20:46:06,577 - quantizer - INFO - Quantizing self_attn.q_proj in block 5/32...
2024-09-02 20:46:55,170 - quantizer - INFO - Quantizing self_attn.k_proj in block 5/32...
2024-09-02 20:47:07,351 - quantizer - INFO - Quantizing self_attn.v_proj in block 5/32...
2024-09-02 20:47:30,927 - quantizer - INFO - Block 5 initial loss 5.241670608520508
2024-09-02 20:48:04,326 - quantizer - INFO - Block 5 @ epoch 0 new loss 4.202488422393799 old loss 5.241670608520508 BETTER
2024-09-02 20:48:37,498 - quantizer - INFO - Block 5 @ epoch 1 new loss 4.165043354034424 old loss 4.202488422393799 BETTER
2024-09-02 20:49:09,128 - quantizer - INFO - Block 5 @ epoch 2 new loss 4.146152019500732 old loss 4.165043354034424 BETTER
2024-09-02 20:49:41,412 - quantizer - INFO - Block 5 @ epoch 3 new loss 4.1433939933776855 old loss 4.146152019500732 BETTER
2024-09-02 20:50:14,349 - quantizer - INFO - Block 5 @ epoch 4 new loss 4.142209529876709 old loss 4.1433939933776855 BETTER
2024-09-02 20:50:15,401 - quantizer - INFO - Quantizing self_attn.o_proj in block 5/32...
2024-09-02 20:51:16,848 - quantizer - INFO - Block 5 initial loss 691160.125
2024-09-02 20:52:56,115 - quantizer - INFO - Quantizing mlp.gate_proj in block 5/32...
2024-09-02 20:55:30,762 - quantizer - INFO - Quantizing mlp.up_proj in block 5/32...
2024-09-02 20:58:14,230 - quantizer - INFO - Block 5 initial loss 27460422.0
2024-09-02 20:59:46,014 - quantizer - INFO - Quantizing mlp.down_proj in block 5/32...
2024-09-02 21:02:32,252 - quantizer - INFO - Start quantizing block model.layers 6/32
2024-09-02 21:02:32,254 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-02 21:47:52,278 - quantizer - INFO - Quantizing self_attn.q_proj in block 6/32...
2024-09-02 21:48:38,888 - quantizer - INFO - Quantizing self_attn.k_proj in block 6/32...
2024-09-02 21:48:51,014 - quantizer - INFO - Quantizing self_attn.v_proj in block 6/32...
2024-09-02 21:49:15,779 - quantizer - INFO - Block 6 initial loss 13.72269058227539
2024-09-02 21:49:49,939 - quantizer - INFO - Block 6 @ epoch 0 new loss 11.596596717834473 old loss 13.72269058227539 BETTER
2024-09-02 21:50:24,327 - quantizer - INFO - Block 6 @ epoch 1 new loss 11.440500259399414 old loss 11.596596717834473 BETTER
2024-09-02 21:51:31,683 - quantizer - INFO - Block 6 @ epoch 3 new loss 11.322210311889648 old loss 11.440500259399414 BETTER
2024-09-02 21:52:05,109 - quantizer - INFO - Block 6 @ epoch 4 new loss 11.264397621154785 old loss 11.322210311889648 BETTER
2024-09-02 21:52:05,919 - quantizer - INFO - Quantizing self_attn.o_proj in block 6/32...
2024-09-02 21:53:01,934 - quantizer - INFO - Block 6 initial loss 1843335.25
2024-09-02 21:54:40,613 - quantizer - INFO - Quantizing mlp.gate_proj in block 6/32...
2024-09-02 21:57:17,337 - quantizer - INFO - Quantizing mlp.up_proj in block 6/32...
2024-09-02 22:00:05,583 - quantizer - INFO - Block 6 initial loss 48982940.0
2024-09-02 22:01:41,436 - quantizer - INFO - Quantizing mlp.down_proj in block 6/32...
2024-09-02 22:04:31,251 - quantizer - INFO - Start quantizing block model.layers 7/32
2024-09-02 22:04:31,252 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-02 22:49:52,572 - quantizer - INFO - Quantizing self_attn.q_proj in block 7/32...
2024-09-02 22:50:39,569 - quantizer - INFO - Quantizing self_attn.k_proj in block 7/32...
2024-09-02 22:50:52,176 - quantizer - INFO - Quantizing self_attn.v_proj in block 7/32...
2024-09-02 22:51:17,120 - quantizer - INFO - Block 7 initial loss 21.00766944885254
2024-09-02 22:51:51,842 - quantizer - INFO - Block 7 @ epoch 0 new loss 18.93838119506836 old loss 21.00766944885254 BETTER
2024-09-02 22:53:00,437 - quantizer - INFO - Block 7 @ epoch 2 new loss 18.92923355102539 old loss 18.93838119506836 BETTER
2024-09-02 22:53:35,272 - quantizer - INFO - Block 7 @ epoch 3 new loss 18.587491989135742 old loss 18.92923355102539 BETTER
2024-09-02 22:54:10,189 - quantizer - INFO - Quantizing self_attn.o_proj in block 7/32...
2024-09-02 22:55:07,260 - quantizer - INFO - Block 7 initial loss 2987010.5
2024-09-02 22:56:50,030 - quantizer - INFO - Quantizing mlp.gate_proj in block 7/32...
2024-09-02 22:59:27,375 - quantizer - INFO - Quantizing mlp.up_proj in block 7/32...
2024-09-02 23:02:13,640 - quantizer - INFO - Block 7 initial loss 55878256.0
2024-09-02 23:03:49,935 - quantizer - INFO - Quantizing mlp.down_proj in block 7/32...
2024-09-02 23:06:38,582 - quantizer - INFO - Start quantizing block model.layers 8/32
2024-09-02 23:06:38,583 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-02 23:51:59,956 - quantizer - INFO - Quantizing self_attn.q_proj in block 8/32...
2024-09-02 23:52:44,963 - quantizer - INFO - Quantizing self_attn.k_proj in block 8/32...
2024-09-02 23:52:57,359 - quantizer - INFO - Quantizing self_attn.v_proj in block 8/32...
2024-09-02 23:53:22,231 - quantizer - INFO - Block 8 initial loss 39.844417572021484
2024-09-02 23:53:56,400 - quantizer - INFO - Block 8 @ epoch 0 new loss 37.81006622314453 old loss 39.844417572021484 BETTER
2024-09-02 23:54:30,810 - quantizer - INFO - Block 8 @ epoch 1 new loss 37.031982421875 old loss 37.81006622314453 BETTER
2024-09-02 23:55:06,610 - quantizer - INFO - Block 8 @ epoch 2 new loss 36.42885971069336 old loss 37.031982421875 BETTER
2024-09-02 23:56:18,080 - quantizer - INFO - Quantizing self_attn.o_proj in block 8/32...
2024-09-02 23:57:14,153 - quantizer - INFO - Block 8 initial loss 5654728.5
2024-09-02 23:58:58,331 - quantizer - INFO - Quantizing mlp.gate_proj in block 8/32...
2024-09-03 00:01:36,048 - quantizer - INFO - Quantizing mlp.up_proj in block 8/32...
2024-09-03 00:04:21,195 - quantizer - INFO - Block 8 initial loss 93398392.0
2024-09-03 00:05:56,790 - quantizer - INFO - Quantizing mlp.down_proj in block 8/32...
2024-09-03 00:08:42,010 - quantizer - INFO - Start quantizing block model.layers 9/32
2024-09-03 00:08:42,012 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 00:53:57,263 - quantizer - INFO - Quantizing self_attn.q_proj in block 9/32...
2024-09-03 00:54:42,170 - quantizer - INFO - Quantizing self_attn.k_proj in block 9/32...
2024-09-03 00:54:54,560 - quantizer - INFO - Quantizing self_attn.v_proj in block 9/32...
2024-09-03 00:55:17,886 - quantizer - INFO - Block 9 initial loss 45.04126739501953
2024-09-03 00:55:50,484 - quantizer - INFO - Block 9 @ epoch 0 new loss 44.31998825073242 old loss 45.04126739501953 BETTER
2024-09-03 00:57:28,007 - quantizer - INFO - Block 9 @ epoch 3 new loss 44.03448486328125 old loss 44.31998825073242 BETTER
2024-09-03 00:58:01,287 - quantizer - INFO - Quantizing self_attn.o_proj in block 9/32...
2024-09-03 00:58:56,433 - quantizer - INFO - Block 9 initial loss 6516543.5
2024-09-03 01:00:34,144 - quantizer - INFO - Quantizing mlp.gate_proj in block 9/32...
2024-09-03 01:03:08,985 - quantizer - INFO - Quantizing mlp.up_proj in block 9/32...
2024-09-03 01:05:52,011 - quantizer - INFO - Block 9 initial loss 99426168.0
2024-09-03 01:07:22,502 - quantizer - INFO - Quantizing mlp.down_proj in block 9/32...
2024-09-03 01:10:08,239 - quantizer - INFO - Start quantizing block model.layers 10/32
2024-09-03 01:10:08,240 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 01:55:21,542 - quantizer - INFO - Quantizing self_attn.q_proj in block 10/32...
2024-09-03 01:56:06,101 - quantizer - INFO - Quantizing self_attn.k_proj in block 10/32...
2024-09-03 01:56:18,458 - quantizer - INFO - Quantizing self_attn.v_proj in block 10/32...
2024-09-03 01:56:42,535 - quantizer - INFO - Block 10 initial loss 58.517791748046875
2024-09-03 01:57:15,122 - quantizer - INFO - Block 10 @ epoch 0 new loss 56.9099006652832 old loss 58.517791748046875 BETTER
2024-09-03 01:58:50,673 - quantizer - INFO - Quantizing self_attn.o_proj in block 10/32...
2024-09-03 01:59:45,377 - quantizer - INFO - Block 10 initial loss 8795826.0
2024-09-03 02:01:22,148 - quantizer - INFO - Quantizing mlp.gate_proj in block 10/32...
2024-09-03 02:03:57,517 - quantizer - INFO - Quantizing mlp.up_proj in block 10/32...
2024-09-03 02:06:39,929 - quantizer - INFO - Block 10 initial loss 350056640.0
2024-09-03 02:08:08,543 - quantizer - INFO - Quantizing mlp.down_proj in block 10/32...
2024-09-03 02:10:54,546 - quantizer - INFO - Start quantizing block model.layers 11/32
2024-09-03 02:10:54,547 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 02:56:09,786 - quantizer - INFO - Quantizing self_attn.q_proj in block 11/32...
2024-09-03 02:56:54,627 - quantizer - INFO - Quantizing self_attn.k_proj in block 11/32...
2024-09-03 02:57:09,915 - quantizer - INFO - Quantizing self_attn.v_proj in block 11/32...
2024-09-03 02:57:34,027 - quantizer - INFO - Block 11 initial loss 113.89495849609375
2024-09-03 02:58:06,515 - quantizer - INFO - Block 11 @ epoch 0 new loss 112.95390319824219 old loss 113.89495849609375 BETTER
2024-09-03 02:59:45,369 - quantizer - INFO - Quantizing self_attn.o_proj in block 11/32...
2024-09-03 03:00:40,961 - quantizer - INFO - Block 11 initial loss 17559428.0
2024-09-03 03:02:19,448 - quantizer - INFO - Quantizing mlp.gate_proj in block 11/32...
2024-09-03 03:04:55,675 - quantizer - INFO - Quantizing mlp.up_proj in block 11/32...
2024-09-03 03:07:39,341 - quantizer - INFO - Block 11 initial loss 106384512.0
2024-09-03 03:09:10,219 - quantizer - INFO - Quantizing mlp.down_proj in block 11/32...
2024-09-03 03:11:55,767 - quantizer - INFO - Start quantizing block model.layers 12/32
2024-09-03 03:11:55,770 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 03:57:11,584 - quantizer - INFO - Quantizing self_attn.q_proj in block 12/32...
2024-09-03 03:57:56,457 - quantizer - INFO - Quantizing self_attn.k_proj in block 12/32...
2024-09-03 03:58:08,797 - quantizer - INFO - Quantizing self_attn.v_proj in block 12/32...
2024-09-03 03:58:32,220 - quantizer - INFO - Block 12 initial loss 96.75962829589844
2024-09-03 03:59:05,109 - quantizer - INFO - Block 12 @ epoch 0 new loss 96.2728500366211 old loss 96.75962829589844 BETTER
2024-09-03 04:00:43,256 - quantizer - INFO - Quantizing self_attn.o_proj in block 12/32...
2024-09-03 04:01:38,683 - quantizer - INFO - Block 12 initial loss 13885150.0
2024-09-03 04:02:11,002 - quantizer - INFO - Block 12 @ epoch 0 new loss 13825412.0 old loss 13885150.0 BETTER
2024-09-03 04:03:50,549 - quantizer - INFO - Quantizing mlp.gate_proj in block 12/32...
2024-09-03 04:06:26,291 - quantizer - INFO - Quantizing mlp.up_proj in block 12/32...
2024-09-03 04:09:09,008 - quantizer - INFO - Block 12 initial loss 98385664.0
2024-09-03 04:10:40,193 - quantizer - INFO - Quantizing mlp.down_proj in block 12/32...
2024-09-03 04:13:27,144 - quantizer - INFO - Start quantizing block model.layers 13/32
2024-09-03 04:13:27,146 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 04:58:44,622 - quantizer - INFO - Quantizing self_attn.q_proj in block 13/32...
2024-09-03 04:59:29,367 - quantizer - INFO - Quantizing self_attn.k_proj in block 13/32...
2024-09-03 04:59:41,583 - quantizer - INFO - Quantizing self_attn.v_proj in block 13/32...
2024-09-03 05:00:05,968 - quantizer - INFO - Block 13 initial loss 177.42991638183594
2024-09-03 05:00:39,222 - quantizer - INFO - Block 13 @ epoch 0 new loss 177.12945556640625 old loss 177.42991638183594 BETTER
2024-09-03 05:02:17,719 - quantizer - INFO - Quantizing self_attn.o_proj in block 13/32...
2024-09-03 05:03:13,109 - quantizer - INFO - Block 13 initial loss 27311052.0
2024-09-03 05:04:52,121 - quantizer - INFO - Quantizing mlp.gate_proj in block 13/32...
2024-09-03 05:07:27,051 - quantizer - INFO - Quantizing mlp.up_proj in block 13/32...
2024-09-03 05:10:11,023 - quantizer - INFO - Block 13 initial loss 182911152.0
2024-09-03 05:11:41,530 - quantizer - INFO - Quantizing mlp.down_proj in block 13/32...
2024-09-03 05:14:29,743 - quantizer - INFO - Start quantizing block model.layers 14/32
2024-09-03 05:14:29,746 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 05:59:45,567 - quantizer - INFO - Quantizing self_attn.q_proj in block 14/32...
2024-09-03 06:00:30,104 - quantizer - INFO - Quantizing self_attn.k_proj in block 14/32...
2024-09-03 06:00:42,924 - quantizer - INFO - Quantizing self_attn.v_proj in block 14/32...
2024-09-03 06:01:06,552 - quantizer - INFO - Block 14 initial loss 190.31076049804688
2024-09-03 06:02:44,845 - quantizer - INFO - Quantizing self_attn.o_proj in block 14/32...
2024-09-03 06:03:39,994 - quantizer - INFO - Block 14 initial loss 27114760.0
2024-09-03 06:05:18,917 - quantizer - INFO - Quantizing mlp.gate_proj in block 14/32...
2024-09-03 06:07:52,652 - quantizer - INFO - Quantizing mlp.up_proj in block 14/32...
2024-09-03 06:10:37,856 - quantizer - INFO - Block 14 initial loss 128340488.0
2024-09-03 06:12:08,927 - quantizer - INFO - Quantizing mlp.down_proj in block 14/32...
2024-09-03 06:14:57,805 - quantizer - INFO - Start quantizing block model.layers 15/32
2024-09-03 06:14:57,806 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 07:00:14,923 - quantizer - INFO - Quantizing self_attn.q_proj in block 15/32...
2024-09-03 07:01:00,865 - quantizer - INFO - Quantizing self_attn.k_proj in block 15/32...
2024-09-03 07:01:13,024 - quantizer - INFO - Quantizing self_attn.v_proj in block 15/32...
2024-09-03 07:01:37,327 - quantizer - INFO - Block 15 initial loss 163.66065979003906
2024-09-03 07:03:16,927 - quantizer - INFO - Quantizing self_attn.o_proj in block 15/32...
2024-09-03 07:04:13,448 - quantizer - INFO - Block 15 initial loss 20571334.0
2024-09-03 07:05:50,886 - quantizer - INFO - Quantizing mlp.gate_proj in block 15/32...
2024-09-03 07:08:26,975 - quantizer - INFO - Quantizing mlp.up_proj in block 15/32...
2024-09-03 07:11:10,784 - quantizer - INFO - Block 15 initial loss 202629984.0
2024-09-03 07:11:41,318 - quantizer - INFO - Block 15 @ epoch 0 new loss 200326112.0 old loss 202629984.0 BETTER
2024-09-03 07:12:10,963 - quantizer - INFO - Block 15 @ epoch 1 new loss 195609088.0 old loss 200326112.0 BETTER
2024-09-03 07:12:41,559 - quantizer - INFO - Block 15 @ epoch 2 new loss 192394672.0 old loss 195609088.0 BETTER
2024-09-03 07:13:11,471 - quantizer - INFO - Block 15 @ epoch 3 new loss 189697360.0 old loss 192394672.0 BETTER
2024-09-03 07:13:41,100 - quantizer - INFO - Block 15 @ epoch 4 new loss 187384080.0 old loss 189697360.0 BETTER
2024-09-03 07:13:41,461 - quantizer - INFO - Quantizing mlp.down_proj in block 15/32...
2024-09-03 07:16:26,768 - quantizer - INFO - Start quantizing block model.layers 16/32
2024-09-03 07:16:26,770 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 08:01:45,326 - quantizer - INFO - Quantizing self_attn.q_proj in block 16/32...
2024-09-03 08:02:29,748 - quantizer - INFO - Quantizing self_attn.k_proj in block 16/32...
2024-09-03 08:02:41,902 - quantizer - INFO - Quantizing self_attn.v_proj in block 16/32...
2024-09-03 08:03:05,833 - quantizer - INFO - Block 16 initial loss 189.39474487304688
2024-09-03 08:04:10,024 - quantizer - INFO - Block 16 @ epoch 1 new loss 185.92909240722656 old loss 189.39474487304688 BETTER
2024-09-03 08:04:44,136 - quantizer - INFO - Block 16 @ epoch 2 new loss 185.71841430664062 old loss 185.92909240722656 BETTER
2024-09-03 08:05:16,506 - quantizer - INFO - Block 16 @ epoch 3 new loss 185.1410675048828 old loss 185.71841430664062 BETTER
2024-09-03 08:05:49,866 - quantizer - INFO - Quantizing self_attn.o_proj in block 16/32...
2024-09-03 08:06:45,671 - quantizer - INFO - Block 16 initial loss 23529536.0
2024-09-03 08:08:22,461 - quantizer - INFO - Quantizing mlp.gate_proj in block 16/32...
2024-09-03 08:10:57,349 - quantizer - INFO - Quantizing mlp.up_proj in block 16/32...
2024-09-03 08:13:41,736 - quantizer - INFO - Block 16 initial loss 193870928.0
2024-09-03 08:15:12,548 - quantizer - INFO - Quantizing mlp.down_proj in block 16/32...
2024-09-03 08:17:55,841 - quantizer - INFO - Start quantizing block model.layers 17/32
2024-09-03 08:17:56,372 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 09:03:12,630 - quantizer - INFO - Quantizing self_attn.q_proj in block 17/32...
2024-09-03 09:03:59,521 - quantizer - INFO - Quantizing self_attn.k_proj in block 17/32...
2024-09-03 09:04:16,540 - quantizer - INFO - Quantizing self_attn.v_proj in block 17/32...
2024-09-03 09:04:45,687 - quantizer - INFO - Block 17 initial loss 175.8003387451172
2024-09-03 09:05:54,454 - quantizer - INFO - Block 17 @ epoch 1 new loss 173.1881561279297 old loss 175.8003387451172 BETTER
2024-09-03 09:06:28,789 - quantizer - INFO - Block 17 @ epoch 2 new loss 169.70230102539062 old loss 173.1881561279297 BETTER
2024-09-03 09:07:04,391 - quantizer - INFO - Block 17 @ epoch 3 new loss 168.15794372558594 old loss 169.70230102539062 BETTER
2024-09-03 09:07:39,501 - quantizer - INFO - Quantizing self_attn.o_proj in block 17/32...
2024-09-03 09:08:38,238 - quantizer - INFO - Block 17 initial loss 21091174.0
2024-09-03 09:10:17,708 - quantizer - INFO - Quantizing mlp.gate_proj in block 17/32...
2024-09-03 09:12:53,061 - quantizer - INFO - Quantizing mlp.up_proj in block 17/32...
2024-09-03 09:15:38,491 - quantizer - INFO - Block 17 initial loss 507154048.0
2024-09-03 09:16:41,572 - quantizer - INFO - Block 17 @ epoch 1 new loss 505577888.0 old loss 507154048.0 BETTER
2024-09-03 09:17:13,441 - quantizer - INFO - Block 17 @ epoch 2 new loss 498008032.0 old loss 505577888.0 BETTER
2024-09-03 09:17:44,371 - quantizer - INFO - Block 17 @ epoch 3 new loss 492339488.0 old loss 498008032.0 BETTER
2024-09-03 09:18:15,397 - quantizer - INFO - Block 17 @ epoch 4 new loss 488672800.0 old loss 492339488.0 BETTER
2024-09-03 09:18:16,072 - quantizer - INFO - Quantizing mlp.down_proj in block 17/32...
2024-09-03 09:21:03,261 - quantizer - INFO - Start quantizing block model.layers 18/32
2024-09-03 09:21:03,264 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 10:06:19,759 - quantizer - INFO - Quantizing self_attn.q_proj in block 18/32...
2024-09-03 10:07:06,601 - quantizer - INFO - Quantizing self_attn.k_proj in block 18/32...
2024-09-03 10:07:24,074 - quantizer - INFO - Quantizing self_attn.v_proj in block 18/32...
2024-09-03 10:07:48,471 - quantizer - INFO - Block 18 initial loss 233.84698486328125
2024-09-03 10:09:30,829 - quantizer - INFO - Quantizing self_attn.o_proj in block 18/32...
2024-09-03 10:10:29,607 - quantizer - INFO - Block 18 initial loss 29198644.0
2024-09-03 10:12:09,087 - quantizer - INFO - Quantizing mlp.gate_proj in block 18/32...
2024-09-03 10:14:44,180 - quantizer - INFO - Quantizing mlp.up_proj in block 18/32...
2024-09-03 10:17:28,650 - quantizer - INFO - Block 18 initial loss 301276128.0
2024-09-03 10:18:31,408 - quantizer - INFO - Block 18 @ epoch 1 new loss 300555040.0 old loss 301276128.0 BETTER
2024-09-03 10:19:02,990 - quantizer - INFO - Block 18 @ epoch 2 new loss 298564160.0 old loss 300555040.0 BETTER
2024-09-03 10:19:33,539 - quantizer - INFO - Block 18 @ epoch 3 new loss 296639776.0 old loss 298564160.0 BETTER
2024-09-03 10:20:04,994 - quantizer - INFO - Block 18 @ epoch 4 new loss 295009984.0 old loss 296639776.0 BETTER
2024-09-03 10:20:05,512 - quantizer - INFO - Quantizing mlp.down_proj in block 18/32...
2024-09-03 10:22:52,885 - quantizer - INFO - Start quantizing block model.layers 19/32
2024-09-03 10:22:52,887 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 11:08:11,422 - quantizer - INFO - Quantizing self_attn.q_proj in block 19/32...
2024-09-03 11:08:59,314 - quantizer - INFO - Quantizing self_attn.k_proj in block 19/32...
2024-09-03 11:09:16,103 - quantizer - INFO - Quantizing self_attn.v_proj in block 19/32...
2024-09-03 11:09:39,856 - quantizer - INFO - Block 19 initial loss 229.0133056640625
2024-09-03 11:11:23,496 - quantizer - INFO - Quantizing self_attn.o_proj in block 19/32...
2024-09-03 11:12:23,406 - quantizer - INFO - Block 19 initial loss 30058366.0
2024-09-03 11:14:05,019 - quantizer - INFO - Quantizing mlp.gate_proj in block 19/32...
2024-09-03 11:16:40,629 - quantizer - INFO - Quantizing mlp.up_proj in block 19/32...
2024-09-03 11:19:26,843 - quantizer - INFO - Block 19 initial loss 406581600.0
2024-09-03 11:19:58,200 - quantizer - INFO - Block 19 @ epoch 0 new loss 397391040.0 old loss 406581600.0 BETTER
2024-09-03 11:20:29,376 - quantizer - INFO - Block 19 @ epoch 1 new loss 388794624.0 old loss 397391040.0 BETTER
2024-09-03 11:20:59,318 - quantizer - INFO - Block 19 @ epoch 2 new loss 385120896.0 old loss 388794624.0 BETTER
2024-09-03 11:21:29,933 - quantizer - INFO - Block 19 @ epoch 3 new loss 382864160.0 old loss 385120896.0 BETTER
2024-09-03 11:22:00,679 - quantizer - INFO - Block 19 @ epoch 4 new loss 382004384.0 old loss 382864160.0 BETTER
2024-09-03 11:22:01,172 - quantizer - INFO - Quantizing mlp.down_proj in block 19/32...
2024-09-03 11:24:46,956 - quantizer - INFO - Start quantizing block model.layers 20/32
2024-09-03 11:24:46,959 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 12:10:04,913 - quantizer - INFO - Quantizing self_attn.q_proj in block 20/32...
2024-09-03 12:10:52,182 - quantizer - INFO - Quantizing self_attn.k_proj in block 20/32...
2024-09-03 12:11:04,700 - quantizer - INFO - Quantizing self_attn.v_proj in block 20/32...
2024-09-03 12:11:28,860 - quantizer - INFO - Block 20 initial loss 227.33241271972656
2024-09-03 12:12:35,807 - quantizer - INFO - Block 20 @ epoch 1 new loss 224.72866821289062 old loss 227.33241271972656 BETTER
2024-09-03 12:13:08,760 - quantizer - INFO - Block 20 @ epoch 2 new loss 220.86105346679688 old loss 224.72866821289062 BETTER
2024-09-03 12:14:16,261 - quantizer - INFO - Quantizing self_attn.o_proj in block 20/32...
2024-09-03 12:15:14,512 - quantizer - INFO - Block 20 initial loss 26000808.0
2024-09-03 12:16:56,167 - quantizer - INFO - Quantizing mlp.gate_proj in block 20/32...
2024-09-03 12:19:31,578 - quantizer - INFO - Quantizing mlp.up_proj in block 20/32...
2024-09-03 12:22:16,140 - quantizer - INFO - Block 20 initial loss 629974336.0
2024-09-03 12:23:49,550 - quantizer - INFO - Quantizing mlp.down_proj in block 20/32...
2024-09-03 12:26:36,395 - quantizer - INFO - Start quantizing block model.layers 21/32
2024-09-03 12:26:36,398 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 13:11:52,340 - quantizer - INFO - Quantizing self_attn.q_proj in block 21/32...
2024-09-03 13:12:38,992 - quantizer - INFO - Quantizing self_attn.k_proj in block 21/32...
2024-09-03 13:12:51,463 - quantizer - INFO - Quantizing self_attn.v_proj in block 21/32...
2024-09-03 13:13:14,561 - quantizer - INFO - Block 21 initial loss 156.4092254638672
2024-09-03 13:14:21,095 - quantizer - INFO - Block 21 @ epoch 1 new loss 153.0687255859375 old loss 156.4092254638672 BETTER
2024-09-03 13:16:01,833 - quantizer - INFO - Quantizing self_attn.o_proj in block 21/32...
2024-09-03 13:17:00,065 - quantizer - INFO - Block 21 initial loss 17629136.0
2024-09-03 13:18:42,046 - quantizer - INFO - Quantizing mlp.gate_proj in block 21/32...
2024-09-03 13:21:17,311 - quantizer - INFO - Quantizing mlp.up_proj in block 21/32...
2024-09-03 13:24:02,785 - quantizer - INFO - Block 21 initial loss 491489632.0
2024-09-03 13:25:35,756 - quantizer - INFO - Quantizing mlp.down_proj in block 21/32...
2024-09-03 13:28:22,807 - quantizer - INFO - Start quantizing block model.layers 22/32
2024-09-03 13:28:22,811 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 14:13:40,096 - quantizer - INFO - Quantizing self_attn.q_proj in block 22/32...
2024-09-03 14:14:27,194 - quantizer - INFO - Quantizing self_attn.k_proj in block 22/32...
2024-09-03 14:14:43,367 - quantizer - INFO - Quantizing self_attn.v_proj in block 22/32...
2024-09-03 14:15:11,468 - quantizer - INFO - Block 22 initial loss 133.19134521484375
2024-09-03 14:16:19,181 - quantizer - INFO - Block 22 @ epoch 1 new loss 133.00355529785156 old loss 133.19134521484375 BETTER
2024-09-03 14:17:59,130 - quantizer - INFO - Quantizing self_attn.o_proj in block 22/32...
2024-09-03 14:18:57,931 - quantizer - INFO - Block 22 initial loss 15165381.0
2024-09-03 14:20:39,079 - quantizer - INFO - Quantizing mlp.gate_proj in block 22/32...
2024-09-03 14:23:15,691 - quantizer - INFO - Quantizing mlp.up_proj in block 22/32...
2024-09-03 14:25:59,976 - quantizer - INFO - Block 22 initial loss 660197440.0
2024-09-03 14:27:33,368 - quantizer - INFO - Quantizing mlp.down_proj in block 22/32...
2024-09-03 14:30:21,030 - quantizer - INFO - Start quantizing block model.layers 23/32
2024-09-03 14:30:21,033 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 15:15:40,461 - quantizer - INFO - Quantizing self_attn.q_proj in block 23/32...
2024-09-03 15:16:27,115 - quantizer - INFO - Quantizing self_attn.k_proj in block 23/32...
2024-09-03 15:16:43,901 - quantizer - INFO - Quantizing self_attn.v_proj in block 23/32...
2024-09-03 15:17:12,845 - quantizer - INFO - Block 23 initial loss 102.25765228271484
2024-09-03 15:18:53,934 - quantizer - INFO - Quantizing self_attn.o_proj in block 23/32...
2024-09-03 15:19:52,939 - quantizer - INFO - Block 23 initial loss 11650749.0
2024-09-03 15:21:33,062 - quantizer - INFO - Quantizing mlp.gate_proj in block 23/32...
2024-09-03 15:24:07,153 - quantizer - INFO - Quantizing mlp.up_proj in block 23/32...
2024-09-03 15:26:50,873 - quantizer - INFO - Block 23 initial loss 710420160.0
2024-09-03 15:28:11,179 - quantizer - INFO - Quantizing mlp.down_proj in block 23/32...
2024-09-03 15:30:56,477 - quantizer - INFO - Start quantizing block model.layers 24/32
2024-09-03 15:30:56,479 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 16:16:12,946 - quantizer - INFO - Quantizing self_attn.q_proj in block 24/32...
2024-09-03 16:17:00,348 - quantizer - INFO - Quantizing self_attn.k_proj in block 24/32...
2024-09-03 16:17:17,284 - quantizer - INFO - Quantizing self_attn.v_proj in block 24/32...
2024-09-03 16:17:46,970 - quantizer - INFO - Block 24 initial loss 150.10354614257812
2024-09-03 16:18:20,548 - quantizer - INFO - Block 24 @ epoch 0 new loss 145.17568969726562 old loss 150.10354614257812 BETTER
2024-09-03 16:18:54,963 - quantizer - INFO - Block 24 @ epoch 1 new loss 144.71299743652344 old loss 145.17568969726562 BETTER
2024-09-03 16:20:35,817 - quantizer - INFO - Quantizing self_attn.o_proj in block 24/32...
2024-09-03 16:21:35,240 - quantizer - INFO - Block 24 initial loss 16032612.0
2024-09-03 16:23:17,764 - quantizer - INFO - Quantizing mlp.gate_proj in block 24/32...
2024-09-03 16:25:54,751 - quantizer - INFO - Quantizing mlp.up_proj in block 24/32...
2024-09-03 16:28:38,412 - quantizer - INFO - Block 24 initial loss 406406368.0
2024-09-03 16:30:00,975 - quantizer - INFO - Quantizing mlp.down_proj in block 24/32...
2024-09-03 16:32:47,725 - quantizer - INFO - Start quantizing block model.layers 25/32
2024-09-03 16:32:47,728 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 17:18:02,211 - quantizer - INFO - Quantizing self_attn.q_proj in block 25/32...
2024-09-03 17:18:48,554 - quantizer - INFO - Quantizing self_attn.k_proj in block 25/32...
2024-09-03 17:19:01,886 - quantizer - INFO - Quantizing self_attn.v_proj in block 25/32...
2024-09-03 17:19:27,921 - quantizer - INFO - Block 25 initial loss 158.34939575195312
2024-09-03 17:20:00,771 - quantizer - INFO - Block 25 @ epoch 0 new loss 148.57164001464844 old loss 158.34939575195312 BETTER
2024-09-03 17:21:36,132 - quantizer - INFO - Quantizing self_attn.o_proj in block 25/32...
2024-09-03 17:22:35,226 - quantizer - INFO - Block 25 initial loss 16543345.0
2024-09-03 17:24:14,990 - quantizer - INFO - Quantizing mlp.gate_proj in block 25/32...
2024-09-03 17:26:51,594 - quantizer - INFO - Quantizing mlp.up_proj in block 25/32...
2024-09-03 17:29:36,800 - quantizer - INFO - Block 25 initial loss 473957920.0
2024-09-03 17:30:55,774 - quantizer - INFO - Quantizing mlp.down_proj in block 25/32...
2024-09-03 17:33:41,319 - quantizer - INFO - Start quantizing block model.layers 26/32
2024-09-03 17:33:41,321 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 18:18:53,380 - quantizer - INFO - Quantizing self_attn.q_proj in block 26/32...
2024-09-03 18:19:39,735 - quantizer - INFO - Quantizing self_attn.k_proj in block 26/32...
2024-09-03 18:19:52,608 - quantizer - INFO - Quantizing self_attn.v_proj in block 26/32...
2024-09-03 18:20:16,728 - quantizer - INFO - Block 26 initial loss 186.7471923828125
2024-09-03 18:20:49,965 - quantizer - INFO - Block 26 @ epoch 0 new loss 171.40223693847656 old loss 186.7471923828125 BETTER
2024-09-03 18:22:29,510 - quantizer - INFO - Quantizing self_attn.o_proj in block 26/32...
2024-09-03 18:23:27,746 - quantizer - INFO - Block 26 initial loss nan
2024-09-03 18:25:05,955 - quantizer - INFO - Quantizing mlp.gate_proj in block 26/32...
2024-09-03 18:27:40,574 - quantizer - INFO - Quantizing mlp.up_proj in block 26/32...
2024-09-03 18:30:24,836 - quantizer - INFO - Block 26 initial loss nan
2024-09-03 18:31:45,014 - quantizer - INFO - Quantizing mlp.down_proj in block 26/32...
2024-09-03 18:34:31,178 - quantizer - INFO - Start quantizing block model.layers 27/32
2024-09-03 18:34:31,181 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 19:19:45,481 - quantizer - INFO - Quantizing self_attn.q_proj in block 27/32...
2024-09-03 19:20:32,638 - quantizer - INFO - Quantizing self_attn.k_proj in block 27/32...
2024-09-03 19:20:45,186 - quantizer - INFO - Quantizing self_attn.v_proj in block 27/32...
2024-09-03 19:21:10,255 - quantizer - INFO - Block 27 initial loss 250.84017944335938
2024-09-03 19:21:43,962 - quantizer - INFO - Block 27 @ epoch 0 new loss 231.6415557861328 old loss 250.84017944335938 BETTER
2024-09-03 19:22:18,118 - quantizer - INFO - Block 27 @ epoch 1 new loss 230.7709503173828 old loss 231.6415557861328 BETTER
2024-09-03 19:22:53,779 - quantizer - INFO - Block 27 @ epoch 2 new loss 230.70684814453125 old loss 230.7709503173828 BETTER
2024-09-03 19:23:27,105 - quantizer - INFO - Block 27 @ epoch 3 new loss 229.68064880371094 old loss 230.70684814453125 BETTER
2024-09-03 19:24:00,870 - quantizer - INFO - Quantizing self_attn.o_proj in block 27/32...
2024-09-03 19:24:58,846 - quantizer - INFO - Block 27 initial loss 23604390.0
2024-09-03 19:26:42,678 - quantizer - INFO - Quantizing mlp.gate_proj in block 27/32...
2024-09-03 19:29:17,450 - quantizer - INFO - Quantizing mlp.up_proj in block 27/32...
2024-09-03 19:32:02,016 - quantizer - INFO - Block 27 initial loss 358340608.0
2024-09-03 19:33:24,220 - quantizer - INFO - Quantizing mlp.down_proj in block 27/32...
2024-09-03 19:36:11,303 - quantizer - INFO - Start quantizing block model.layers 28/32
2024-09-03 19:36:11,305 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 20:21:27,993 - quantizer - INFO - Quantizing self_attn.q_proj in block 28/32...
2024-09-03 20:22:15,082 - quantizer - INFO - Quantizing self_attn.k_proj in block 28/32...
2024-09-03 20:22:31,291 - quantizer - INFO - Quantizing self_attn.v_proj in block 28/32...
2024-09-03 20:23:00,424 - quantizer - INFO - Block 28 initial loss 246.4358673095703
2024-09-03 20:23:33,254 - quantizer - INFO - Block 28 @ epoch 0 new loss 242.18182373046875 old loss 246.4358673095703 BETTER
2024-09-03 20:25:13,323 - quantizer - INFO - Quantizing self_attn.o_proj in block 28/32...
2024-09-03 20:26:08,712 - quantizer - INFO - Block 28 initial loss 25863720.0
2024-09-03 20:27:50,034 - quantizer - INFO - Quantizing mlp.gate_proj in block 28/32...
2024-09-03 20:30:25,048 - quantizer - INFO - Quantizing mlp.up_proj in block 28/32...
2024-09-03 20:33:09,084 - quantizer - INFO - Block 28 initial loss 1376104576.0
2024-09-03 20:34:29,759 - quantizer - INFO - Quantizing mlp.down_proj in block 28/32...
2024-09-03 20:37:16,295 - quantizer - INFO - Start quantizing block model.layers 29/32
2024-09-03 20:37:16,296 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 21:22:32,518 - quantizer - INFO - Quantizing self_attn.q_proj in block 29/32...
2024-09-03 21:23:19,496 - quantizer - INFO - Quantizing self_attn.k_proj in block 29/32...
2024-09-03 21:23:31,395 - quantizer - INFO - Quantizing self_attn.v_proj in block 29/32...
2024-09-03 21:23:55,652 - quantizer - INFO - Block 29 initial loss 298.018310546875
2024-09-03 21:24:29,941 - quantizer - INFO - Block 29 @ epoch 0 new loss 291.9500732421875 old loss 298.018310546875 BETTER
2024-09-03 21:25:03,620 - quantizer - INFO - Block 29 @ epoch 1 new loss 289.37457275390625 old loss 291.9500732421875 BETTER
2024-09-03 21:25:36,714 - quantizer - INFO - Block 29 @ epoch 2 new loss 287.6761779785156 old loss 289.37457275390625 BETTER
2024-09-03 21:26:44,450 - quantizer - INFO - Quantizing self_attn.o_proj in block 29/32...
2024-09-03 21:27:42,382 - quantizer - INFO - Block 29 initial loss 26866982.0
2024-09-03 21:29:23,495 - quantizer - INFO - Quantizing mlp.gate_proj in block 29/32...
2024-09-03 21:31:58,093 - quantizer - INFO - Quantizing mlp.up_proj in block 29/32...
2024-09-03 21:34:43,187 - quantizer - INFO - Block 29 initial loss 1504279936.0
2024-09-03 21:36:02,836 - quantizer - INFO - Quantizing mlp.down_proj in block 29/32...
2024-09-03 21:38:49,364 - quantizer - INFO - Start quantizing block model.layers 30/32
2024-09-03 21:38:49,366 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 22:24:08,118 - quantizer - INFO - Quantizing self_attn.q_proj in block 30/32...
2024-09-03 22:24:56,027 - quantizer - INFO - Quantizing self_attn.k_proj in block 30/32...
2024-09-03 22:25:08,166 - quantizer - INFO - Quantizing self_attn.v_proj in block 30/32...
2024-09-03 22:25:32,358 - quantizer - INFO - Block 30 initial loss 503.9407653808594
2024-09-03 22:26:08,392 - quantizer - INFO - Block 30 @ epoch 0 new loss 497.3404846191406 old loss 503.9407653808594 BETTER
2024-09-03 22:26:42,486 - quantizer - INFO - Block 30 @ epoch 1 new loss 495.22509765625 old loss 497.3404846191406 BETTER
2024-09-03 22:27:16,732 - quantizer - INFO - Block 30 @ epoch 2 new loss 495.1943664550781 old loss 495.22509765625 BETTER
2024-09-03 22:28:25,414 - quantizer - INFO - Quantizing self_attn.o_proj in block 30/32...
2024-09-03 22:29:23,154 - quantizer - INFO - Block 30 initial loss 41914980.0
2024-09-03 22:31:03,032 - quantizer - INFO - Quantizing mlp.gate_proj in block 30/32...
2024-09-03 22:33:37,563 - quantizer - INFO - Quantizing mlp.up_proj in block 30/32...
2024-09-03 22:36:21,025 - quantizer - INFO - Block 30 initial loss 27890139136.0
2024-09-03 22:37:42,901 - quantizer - INFO - Quantizing mlp.down_proj in block 30/32...
2024-09-03 22:40:29,791 - quantizer - INFO - Start quantizing block model.layers 31/32
2024-09-03 22:40:29,794 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-03 23:25:46,405 - quantizer - INFO - Quantizing self_attn.q_proj in block 31/32...
2024-09-03 23:26:33,080 - quantizer - INFO - Quantizing self_attn.k_proj in block 31/32...
2024-09-03 23:26:45,049 - quantizer - INFO - Quantizing self_attn.v_proj in block 31/32...
2024-09-03 23:27:09,964 - quantizer - INFO - Block 31 initial loss 640.9236450195312
2024-09-03 23:27:43,529 - quantizer - INFO - Block 31 @ epoch 0 new loss 603.2157592773438 old loss 640.9236450195312 BETTER
2024-09-03 23:28:18,059 - quantizer - INFO - Block 31 @ epoch 1 new loss 603.18896484375 old loss 603.2157592773438 BETTER
2024-09-03 23:28:51,439 - quantizer - INFO - Block 31 @ epoch 2 new loss 600.8511352539062 old loss 603.18896484375 BETTER
2024-09-03 23:29:24,568 - quantizer - INFO - Block 31 @ epoch 3 new loss 599.8884887695312 old loss 600.8511352539062 BETTER
2024-09-03 23:29:58,203 - quantizer - INFO - Block 31 @ epoch 4 new loss 598.718994140625 old loss 599.8884887695312 BETTER
2024-09-03 23:29:59,000 - quantizer - INFO - Quantizing self_attn.o_proj in block 31/32...
2024-09-03 23:30:57,149 - quantizer - INFO - Block 31 initial loss nan
2024-09-03 23:32:37,999 - quantizer - INFO - Quantizing mlp.gate_proj in block 31/32...
2024-09-03 23:35:12,304 - quantizer - INFO - Quantizing mlp.up_proj in block 31/32...
2024-09-03 23:37:55,768 - quantizer - INFO - Block 31 initial loss nan
2024-09-03 23:39:15,495 - quantizer - INFO - Quantizing mlp.down_proj in block 31/32...
2024-09-03 23:42:01,686 - quantizer - INFO - Start quantizing block model.layers 32/32
2024-09-03 23:42:01,689 - quantizer - INFO - Module to quantize ['self_attn.q_proj', 'self_attn.k_proj', 'self_attn.v_proj', 'self_attn.o_proj', 'mlp.gate_proj', 'mlp.up_proj', 'mlp.down_proj']
2024-09-04 00:27:17,861 - quantizer - INFO - Quantizing self_attn.q_proj in block 32/32...
2024-09-04 00:28:04,773 - quantizer - INFO - Quantizing self_attn.k_proj in block 32/32...
2024-09-04 00:28:16,780 - quantizer - INFO - Quantizing self_attn.v_proj in block 32/32...
2024-09-04 00:28:41,484 - quantizer - INFO - Block 32 initial loss 1420.1217041015625
2024-09-04 00:29:16,373 - quantizer - INFO - Block 32 @ epoch 0 new loss 1408.8411865234375 old loss 1420.1217041015625 BETTER
2024-09-04 00:29:49,453 - quantizer - INFO - Block 32 @ epoch 1 new loss 1393.8419189453125 old loss 1408.8411865234375 BETTER
2024-09-04 00:31:31,609 - quantizer - INFO - Quantizing self_attn.o_proj in block 32/32...
2024-09-04 00:32:27,938 - quantizer - INFO - Block 32 initial loss nan
2024-09-04 00:34:09,161 - quantizer - INFO - Quantizing mlp.gate_proj in block 32/32...
2024-09-04 00:36:44,252 - quantizer - INFO - Quantizing mlp.up_proj in block 32/32...
2024-09-04 00:39:28,989 - quantizer - INFO - Block 32 initial loss nan
2024-09-04 00:40:49,987 - quantizer - INFO - Quantizing mlp.down_proj in block 32/32...
2024-09-04 00:47:04,202 - quantizer - INFO - End2end initial loss nan
2024-09-04 01:32:38,736 - accelerate.accelerator - INFO - Model weights saved in /trinity/home/team14/workspace/quantization/models/Mistral-7B-Instruct-v0.2-quip/pytorch_model.bin
2024-09-04 01:32:46,241 - ipykernel.comm - ERROR - No such comm target registered: jupyter.widget.control
2024-09-04 01:32:46,244 - ipykernel.comm - ERROR - No such comm target registered: jupyter.widget.control
2024-09-04 01:32:46,246 - ipykernel.comm - ERROR - No such comm target registered: jupyter.widget.control
2024-09-04 01:32:46,248 - ipykernel.comm - ERROR - No such comm target registered: jupyter.widget.control
2024-09-04 01:32:46,250 - ipykernel.comm - ERROR - No such comm target registered: jupyter.widget.control
2024-09-04 01:32:46,253 - ipykernel.comm - ERROR - No such comm target registered: jupyter.widget.control
2024-09-04 01:32:46,256 - ipykernel.comm - ERROR - No such comm target registered: jupyter.widget.control
2024-09-04 01:32:46,259 - ipykernel.comm - ERROR - No such comm target registered: jupyter.widget.control
2024-09-04 01:32:46,262 - Comm - WARNING - No such comm: f88af9bf-d05c-4089-9604-95ebeb9a1341
2024-09-04 01:32:46,264 - Comm - WARNING - No such comm: fc799ca7-91a4-4592-a41f-402861841c11
2024-09-04 01:32:46,266 - Comm - WARNING - No such comm: 73b5b306-e4ce-405c-9a19-03dbef1b5c46
2024-09-04 01:32:46,268 - Comm - WARNING - No such comm: 09e5e326-6e6e-4124-b974-185d03fc98b7
2024-09-04 01:32:46,270 - Comm - WARNING - No such comm: 0f065914-4d9a-4bc3-88d3-d981df28a3e2
2024-09-04 01:32:46,273 - Comm - WARNING - No such comm: 33cb24d0-c644-452d-9da6-04af837ccb3a
2024-09-04 01:32:46,275 - Comm - WARNING - No such comm: 89f2be2a-9b7d-43be-bbad-c27d2d5cd8c3
2024-09-04 01:32:46,277 - Comm - WARNING - No such comm: 949d3f9d-d6f5-4ff0-9955-b9321cff119e
2024-09-04 06:02:05,141 - ipykernel.comm - ERROR - No such comm target registered: jupyter.widget.control
2024-09-04 06:02:05,144 - Comm - WARNING - No such comm: 30c1239f-f178-4f0e-8f0d-c2e5ffeb30e6
2024-09-04 06:02:52,633 - accelerate.accelerator - INFO - Model weights saved in /trinity/home/team14/workspace/quantization/models/Mistral-7B-Instruct-v0.2-quip/pytorch_model.bin
2024-09-04 06:04:55,250 - accelerate.accelerator - INFO - Model weights saved in /root/llm_quant_safety/quantization/models/Mistral-7B-Instruct-v0.2-quip-2bit/pytorch_model.bin
